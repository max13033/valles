(function(){if(window.BXMailMessageController)return;var t={};t.init=function(t){if(this.__inited)return;this.options=t;this.__dummyNode=document.createElement("DIV");if("edit"!=this.options.type){if(this.options.pageSize<1||this.options.pageSize>100)this.options.pageSize=5;this.__log={a:0,b:0};var e=BX("mail-msg-view-details-"+this.options.messageId);var i=BX.findChildByClassName(e.parentNode,"mail-msg-view-log-more-a",true);BX.bind(i,"click",this.handleLogClick.bind(this,"a"));var s=BX.findChildByClassName(e.parentNode,"mail-msg-view-log-more-b",true);BX.bind(s,"click",this.handleLogClick.bind(this,"b"));var a=BX.findChildrenByClassName(e.parentNode,"mail-msg-view-log-item",true);for(var o in a){var n=a[o].getAttribute("data-log").toLowerCase();if(typeof this.__log[n]!="undefined")this.__log[n]++;BX.bind(a[o],"click",this.handleLogItemClick.bind(this,a[o].getAttribute("data-id")))}BX.Event.EventEmitter.subscribe("BXMailMessageActions:CRM_ACTIVITY",function(t){BX.show(BX.findChildByClassName(BX("mail-msg-view-details-"+t.getData().messageId),"js-msg-view-control-skip",true))});BX.Event.EventEmitter.subscribe("BXMailMessageActions:CRM_EXCLUDE",function(t){BX.hide(BX.findChildByClassName(BX("mail-msg-view-details-"+t.getData().messageId),"js-msg-view-control-skip",true))})}this.__inited=true};t.initScrollable=function(){if(!this.__scrollable){if(document.scrollingElement)this.__scrollable=document.scrollingElement}if(!this.__scrollable){if(document.documentElement.scrollTop>0||document.documentElement.scrollLeft>0)this.__scrollable=document.documentElement;else if(document.body.scrollTop>0||document.body.scrollLeft>0)this.__scrollable=document.body}if(!this.__scrollable){window.scrollBy(1,1);if(document.documentElement.scrollTop>0||document.documentElement.scrollLeft>0)this.__scrollable=document.documentElement;else if(document.body.scrollTop>0||document.body.scrollLeft>0)this.__scrollable=document.body;window.scrollBy(-1,-1)}return this.__scrollable};t.scrollWrapper=function(t){var e=this;if(!this.initScrollable())return;if(this.__scrollable.__animation){clearInterval(this.__scrollable.__animation);this.__scrollable.__animation=null}var i=this.__scrollable.scrollTop;var s=t-i;var a=0;this.__scrollable.__animation=setInterval(function(){a++;e.__scrollable.scrollTop=i+s*a/8;if(a>=8){clearInterval(e.__scrollable.__animation);e.__scrollable.__animation=null}},20)};t.scrollTo=function(t,e){if(!this.initScrollable())return;var i=BX.pos(this.__scrollable);i.top+=this.__scrollable.scrollTop;i.bottom+=this.__scrollable.scrollTop;var s=BX.pos(t);var a=typeof e=="undefined"||e===t?s:BX.pos(e);if(s.top<i.top){this.scrollWrapper(this.__scrollable.scrollTop-(i.top-s.top))}else if(a.bottom>i.bottom){this.scrollWrapper(Math.min(this.__scrollable.scrollTop-(i.top-s.top),this.__scrollable.scrollTop+(a.bottom-i.bottom)))}};t.handleLogClick=function(t,e){BX.PreventDefault(e);var i=BX.findChildByClassName(BX("mail-msg-view-details-"+this.options.messageId).parentNode,"mail-msg-view-log-more-"+t,true);this.loadLog(t,i)};t.loadLog=function(t,e){var i=this;var s=e.parentNode;if(this["__loadingLog"+t])return;this["__loadingLog"+t]=true;var a={sessid:BX.bitrix_sessid(),action:"log",id:this.options.messageId,log:t+this.__log[t],size:this.options.pageSize};if(this.options.mail_uf_message_token){a.mail_uf_message_token=this.options.mail_uf_message_token}BX.ajax({method:"POST",url:BX.util.add_url_param(this.options.ajaxUrl,{action:"log"}),data:a,dataType:"json",onsuccess:function(e){i["__loadingLog"+t]=false;if(e.status=="success"){i.__dummyNode.innerHTML=e.data.html;var a=t=="a"?BX.findNextSibling(s,{tag:"div"}):s;while(i.__dummyNode.childNodes.length>0){var o=s.parentNode.insertBefore(i.__dummyNode.childNodes[0],a);if(o.nodeType==1&&BX.hasClass(o,"mail-msg-view-log-item")){i.__log[t]++;BX.addClass(o,"mail-msg-show-animation-rev");BX.bind(o,"click",i.handleLogItemClick.bind(i,o.getAttribute("data-id")))}}if(e.data.count<i.options.pageSize)s.style.display="none";if(t=="b"&&i.initScrollable()){i.scrollWrapper(i.__scrollable.scrollHeight)}i.__dummyNode.innerHTML=""}},onfailure:function(){i["__loadingLog"+t]=false}})};t.handleLogItemClick=function(t,e){e=e||window.event;if(e.target&&e.target.tagName&&e.target.tagName.toUpperCase()=="A")return;if(window.getSelection){if(window.getSelection().toString().trim()!="")return}else if(document.selection){if(document.selection.createRange().htmlText.trim()!="")return}BX.PreventDefault(e);this.toggleLogItem(t)};t.toggleLogItem=function(t){var e=this;var i=BX("mail-msg-view-details-"+this.options.messageId).parentNode;var s=BX.findChildByClassName(i,"mail-msg-view-logitem-"+t,false);var a=BX.findChildByClassName(i,"mail-msg-view-details-"+t,false);var o=BX.hasClass(s,"mail-msg-view-item-open");BX.removeClass(s,"mail-msg-show-animation-rev");BX.toggleClass(s,"mail-msg-view-item-open");if(o){a.style.display="none";BX.addClass(s,"mail-msg-show-animation-rev");s.style.display=""}else{BX.removeClass(a,"mail-msg-show-animation-rev");BX.addClass(a,"mail-msg-show-animation");a.style.display="";if(a.getAttribute("data-empty")){var n={sessid:BX.bitrix_sessid(),action:"logitem",id:t};if(this.options.mail_uf_message_token){n.mail_uf_message_token=this.options.mail_uf_message_token}BX.ajax({method:"POST",url:BX.util.add_url_param(this.options.ajaxUrl,{action:"logitem"}),data:n,dataType:"json",onsuccess:function(i){if(i.status!="success"){i.errors=i.errors.map(function(t){return t.message});a.innerHTML='<div class="mail-msg-view-log-item-error mail-msg-view-border-bottom">'+i.errors.join("<br>")+"</div>";return}var o=BX.processHTML(i.data);BX.removeClass(a,"mail-msg-show-animation");BX.removeClass(a,"mail-msg-show-animation-rev");setTimeout(function(){a.style.textAlign="";a.innerHTML=o.HTML;if(a.offsetHeight>0)s.style.display="none";BX.ajax.processScripts(o.SCRIPT);BX.addClass(a,"mail-msg-show-animation-rev");var i=BX.findChildByClassName(a,"mail-msg-view-header",true);BX.bind(i,"click",e.handleLogItemClick.bind(e,t));e.scrollTo(a)},10);a.removeAttribute("data-empty")}});this.scrollTo(s,a)}else{s.style.display="none";this.scrollTo(a)}}};t.removeLogItem=function(t){var e=BX("mail-msg-view-details-"+this.options.messageId).parentNode;var i=BX.findChildByClassName(e,"mail-msg-view-logitem-"+t,false);var s=BX.findChildByClassName(e,"mail-msg-view-details-"+t,false);var a=i.getAttribute("data-log").toLowerCase();if(typeof this.__log[a]!="undefined")this.__log[a]--;setTimeout(function(){e.removeChild(s);e.removeChild(i)},200);s.style.maxHeight=s.offsetHeight*1.5+"px";s.style.transition="max-height .2s ease-in";s.offsetHeight;s.style.maxHeight="0px";BX.removeClass(s,"mail-msg-show-animation");BX.removeClass(s,"mail-msg-show-animation-rev");BX.addClass(s,"mail-msg-close-animation")};t.close=function(t){var e=top.BX.SidePanel.Instance.getSliderByWindow(window);if(e){e.setCacheable(!t);e.close()}else{window.location.href=BX.util.add_url_param(this.options.pathList,{strict:"N"})}};var e=function(i){var s=this;this.ctrl=t;this.options=i;this.__dummyNode=document.createElement("DIV");this.htmlForm=BX(this.options.formId);this.htmlForm.__wrapper=this.htmlForm.parentNode;if(this.htmlForm.__inited)return;if("edit"!=this.ctrl.options.type){this.__wrapper=BX("mail-msg-view-details-"+this.ctrl.options.messageId);if(this.options.messageId!=this.ctrl.options.messageId)this.__wrapper=BX.findChildByClassName(this.__wrapper.parentNode,"mail-msg-view-details-"+this.options.messageId,false);BX.addCustomEvent("MailMessage:replyButtonClick",function(t){if(t!==s)s.hideReplyForm()});top.BX.SidePanel.Instance.postMessage(window,"mail-message-view",{id:this.options.messageId});var a="mail_msg_"+this.options.messageId+"_body";var o=typeof document.querySelectorAll!="undefined"?document.querySelectorAll("#"+a+" a"):BX.findChildren(BX(a),{tag:"a"},true);for(var n in o){if(!o.hasOwnProperty(n))continue;if(o[n]&&o[n].setAttribute)o[n].setAttribute("target","_blank")}var l=typeof document.querySelectorAll!="undefined"?document.querySelectorAll("#"+a+" blockquote"):BX.findChildren(BX(a),{tag:"blockquote"},true);for(var n in l){if(!l.hasOwnProperty(n))continue;BX.bind(l[n],"click",function(){BX.addClass(this,"mail-msg-view-quote-unfolded")})}var r=BX.findChildrenByClassName(this.__wrapper,"mail-msg-view-rcpt-more");for(var n in r){BX.bind(r[n],"click",function(t){BX.findChildByClassName(this.parentNode,"mail-msg-view-rcpt-list-hidden",false).style.display="inline";this.style.display="none";BX.PreventDefault(t)})}var d=BX.findChildByClassName(this.__wrapper,"js-msg-view-reply-panel",true);var m=BX.findChildByClassName(this.__wrapper,"js-msg-view-control-reply",true);var c=BX.findChildByClassName(this.__wrapper,"js-msg-view-control-replyall",true);var p=BX.findChildByClassName(this.__wrapper,"js-msg-view-control-forward",true);var u=BX.findChildByClassName(this.__wrapper,"js-msg-view-control-skip",true);var h=BX.findChildByClassName(this.__wrapper,"js-msg-view-control-spam",true);var _=BX.findChildByClassName(this.__wrapper,"js-msg-view-control-delete",true);BX.bind(d,"click",this.showReplyForm.bind(this));BX.bind(c,"click",this.showReplyForm.bind(this));BX.bind(m,"click",this.showReplyForm.bind(this,true));BX.bind(p,"click",function(){var t={forward:s.options.messageId};if(s.ctrl.options.mail_uf_message_token){t.mail_uf_message_token=s.ctrl.options.mail_uf_message_token}window.location.href=BX.util.add_url_param(s.ctrl.options.pathNew,t)});BX.bind(u,"click",function(t){BXMailMessageActions&&BXMailMessageActions.createAction(t,{messageId:s.options.messageId,value:"CRM_EXCLUDE",disable:BX.addClass.bind(BX,u,"mail-msg-view-control-disabled"),enable:BX.removeClass.bind(BX,u,"mail-msg-view-control-disabled")})});var f=document.querySelector("[data-uid-key]");var g=0;if(f){g=f.dataset.uidKey}BX.bind(h,"click",this.markAsSpam.bind(this,h,g));BX.bind(_,"click",this.delete.bind(this,_,g))}var v=BXMainMailForm.getForm(this.options.formId);BX.addCustomEvent(v,"MailForm:footer:buttonClick",e.handleFooterButtonClick.bind(this));BX.addCustomEvent(v,"MailForm:submit",e.handleFormSubmit.bind(this));BX.addCustomEvent(v,"MailForm:submit:ajaxSuccess",e.handleFormSubmitSuccess.bind(this));BX.PULL&&BX.PULL.extendWatch("mail_mailbox_"+this.options.messageId);BX.addCustomEvent("onPullEvent-mail",BX.proxy(function(t,e){if(t!=="onMessageRead"){return}var i=BX("mail-msg-view-details-"+e.messageId);if(!i){i=BX.findChildByClassName(document,"mail-msg-view-logitem-"+e.messageId,true)}if(!i){return}var s=BX.findChildrenByClassName(i,"read-confirmed-datetime",true);if(s&&s.length>0){for(var a in s)BX.adjust(s[a],{text:BX.message("MAIL_MESSAGE_READ_CONFIRMED_SHORT")})}},this));this.htmlForm.__inited=true};e.handleFooterButtonClick=function(t,e){if(BX.hasClass(e,"main-mail-form-cancel-button")){if("edit"==this.ctrl.options.type){this.ctrl.close()}else{this.hideReplyForm()}}};e.handleFormSubmit=function(t,e){var i=this.htmlForm.elements;var s=true;for(var a=0;a<i.length;a++){if("data[to][]"==i[a].name&&i[a].value.length>0)s=false}if(s){t.showError(BX.message("MAIL_MESSAGE_NEW_EMPTY_RCPT"));return BX.PreventDefault(e)}var o;for(var a in t.postForm.controllers){if(!t.postForm.controllers.hasOwnProperty(a))continue;if(t.postForm.controllers[a].storage!="disk")continue;try{o=0;o=t.postForm.controllers[a].handler.agent.upload.filesCount}catch(t){}if(o>0){t.showError(BX.message("MAIL_MESSAGE_NEW_UPLOADING"));return BX.PreventDefault(e)}}};e.handleFormSubmitSuccess=function(t,e){if(e.status!="success"){var i=document.createElement("DIV");if(!e.errors||!BX.type.isArray(e.errors)){e.errors=[{message:BX.message("MAIL_CLIENT_AJAX_ERROR"),code:0}]}for(var s=0;s<e.errors.length;s++){i.appendChild(document.createTextNode(e.errors[s].message));i.appendChild(document.createElement("BR"))}t.showError(i.innerHTML)}else{if("edit"!=this.ctrl.options.type){this.hideReplyForm()}top.BX.SidePanel.Instance.postMessage(window,"Mail.Client.MessageCreatedSuccess",e);top.BX.UI.Notification.Center.notify({autoHideDelay:2e3,content:BX.message("MAIL_MESSAGE_SEND_SUCCESS")});this.ctrl.close(true)}};e.prototype.showReplyForm=function(t){var e=BXMainMailForm.getForm(this.options.formId);var i=BX.findChildByClassName(this.__wrapper,"js-msg-view-reply-panel",true);if(this.htmlForm.parentNode===this.__dummyNode)this.htmlForm.__wrapper.appendChild(this.htmlForm);e.init();if(t===true){e.getField("data[to]").setValue(this.options.rcptSelected);e.getField("data[cc]").setValue()}else{e.getField("data[to]").setValue(this.options.rcptAllSelected);e.getField("data[cc]").setValue(this.options.rcptCcSelected)}e.getField("data[bcc]").setValue();BX.onCustomEvent("MailMessage:replyButtonClick",[this]);BX.addClass(this.htmlForm,"mail-msg-show-animation");this.htmlForm.style.display="";i.style.display="none";BX.onCustomEvent(e,"MailForm:show",[]);this.ctrl.scrollTo(this.htmlForm)};e.prototype.hideReplyForm=function(){var t=BXMainMailForm.getForm(this.options.formId);var e=BX.findChildByClassName(this.__wrapper,"js-msg-view-reply-panel",true);BX.addClass(e,"mail-msg-show-animation-rev");e.style.display="";this.htmlForm.style.display="none";BX.onCustomEvent(t,"MailForm:hide",[]);this.__dummyNode.appendChild(this.htmlForm)};e.prototype.markAsSpam=function(t,e){t.classList.add("mail-msg-view-control-disabled");BX.ajax.runComponentAction("bitrix:mail.client","markAsSpam",{mode:"ajax",data:{ids:[e]}}).then(this.onMessageActionSuccess.bind(this,t),function(t){this.onMessageActionError.bind(this,t)()}.bind(this))};e.prototype.delete=function(t,e){if(t.dataset&&t.dataset.isTrash){if(!this.popupDeleteConfirm){var i=[new BX.PopupWindowButton({text:BX.message("MAIL_MESSAGE_LIST_CONFIRM_CANCEL_BTN"),className:"popup-window-button-cancel",events:{click:BX.delegate(function(){this.popupDeleteConfirm.close()},this)}}),new BX.PopupWindowButton({text:BX.message("MAIL_MESSAGE_LIST_CONFIRM_DELETE_BTN"),className:"popup-window-button-decline",events:{click:BX.delegate(function(){this.processDelete(t,e);this.popupDeleteConfirm.close()},this)}})];this.popupDeleteConfirm=new BX.PopupWindow("bx-mail-message-list-popup-delete-confirm",null,{zIndex:1e3,autoHide:true,buttons:i,closeByEsc:true,titleBar:{content:BX.create("div",{html:'<span class="popup-window-titlebar-text">'+BX.message("MAIL_MESSAGE_LIST_CONFIRM_TITLE")+"</span>"})},events:{onPopupClose:function(){this.destroy()},onPopupDestroy:BX.delegate(function(){this.popupDeleteConfirm=null},this)},content:BX.create("div",{html:BX.message("MAIL_MESSAGE_LIST_CONFIRM_DELETE")})})}this.popupDeleteConfirm.show()}else{this.processDelete(t,e)}};e.prototype.processDelete=function(t,e){t.classList.add("mail-msg-view-control-disabled");BX.ajax.runComponentAction("bitrix:mail.client","delete",{mode:"ajax",data:{ids:[e]}}).then(this.onMessageActionSuccess.bind(this,t),function(t){this.onMessageActionError.bind(this,t)()}.bind(this))};e.prototype.onMessageActionError=function(t){alert(t.errors[0].message)};e.prototype.onMessageActionSuccess=function(t){top.BX.SidePanel.Instance.postMessage(window,"mail-message-reload-grid",{});this.ctrl.close(true)};var i={};i.init=function(t){this.mailbox=t||{};return this};i.sync=function(t,e,s){var a=this;if(a.syncLock){return}a.syncLock=true;if(!BX.type.isDomNode(t)){t=document.createElement("DIV")}BX.addClass(t,"ui-btn-wait");var o=BX.ajax.runComponentAction("bitrix:mail.client","syncMailbox",{mode:"ajax",data:{id:a.mailbox.ID}});o.then(function(o){a.syncLock=false;BX.removeClass(t,"ui-btn-wait");BX.addClass(t,"ui-btn-icon-buisness");BX.removeClass(t,"ui-btn-icon-business-warning");t.setAttribute("title",BX.message("MAIL_MESSAGE_SYNC_BTN_HINT"));i.updateStepper(e,o.data.complete,o.data.status);if(o.data.new>0){BX.Main.gridManager.getInstanceById(s).reload()}},function(e){a.syncLock=false;BX.removeClass(t,"ui-btn-wait");BX.addClass(t,"ui-btn-icon-business-warning");BX.removeClass(t,"ui-btn-icon-buisness");var i=BX.message("MAIL_CLIENT_AJAX_ERROR");if(e.errors&&e.errors.length>0){i+="\n";i+=e.errors.map(function(t){return t.message}).join("\n")}t.setAttribute("title",i)})};i.updateStepper=function(t,e,i){if(e){t.style.display="none"}else{var s=BX.findChildByClassName(t,"main-stepper-bar-line");var a=BX.findChildByClassName(t,"main-stepper-steps");if(i>=0){var i=Math.min(Math.max(Math.round(parseFloat(i)*100),1),99);if(s){s.style.width=i+"%"}if(a){a.innerHTML=i+"%"}}else{if(s){s.style.width="0%"}if(a){a.innerHTML=""}}t.style.display=""}var o=document.createEvent("Event");o.initEvent("resize",true,true);window.dispatchEvent(o)};i.setupDirs=function(t){var e={};try{e=this.mailbox.OPTIONS.imap}catch(t){}var i=e.dirs;var s=e.dirsList;var a=e.ignore||[];var o=e.disabled||[];var n={outcome:BX.type.isArray(e.outcome)&&e.outcome[0]?e.outcome[0]:"",trash:BX.type.isArray(e.trash)&&e.trash[0]?e.trash[0]:"",spam:BX.type.isArray(e.spam)&&e.spam[0]?e.spam[0]:""};if(n.spam==""){n.spam=n.trash}if(i){var l=[];var r,d,m;for(var c=0;c<s.length;c++){d=s[c];if(i.hasOwnProperty(d)){r=i[d];m=r.length-1;l.push({item:r,path:d,name:r[m],level:m,ignore:BX.util.in_array(d,a),disabled:BX.util.in_array(d,o)})}}top.BX.SidePanel.Instance.open("mail:mailbox-setup-dirs",{width:640,cacheable:false,contentCallback:function(t){var e=new top.BX.Promise;var i="",s,a,o;var r=l.length,d,m;i+='<div class="mail-connect-section-block">';i+='<div class="mail-connect-title-block">';i+='<div class="mail-connect-title">'+BX.message("MAIL_CLIENT_CONFIG_IMAP_DIRS_SYNC")+"</div>";i+="</div>";for(d=0;d<r;d++){m=l[d].disabled?"disabled":!l[d].ignore?"checked":"";i+='<div class="mail-connect-option-email mail-connect-form-check-hidden" style="padding-left: '+25*l[d].level+'px">';i+='<input onclick="return document.querySelectorAll(\'.mail-connect-form-input-check:checked\').length > 0; " class="mail-connect-form-input mail-connect-form-input-check" id="imap-dir-sync-n'+d+'" type="checkbox" name="imap_dirs[sync]['+d+']" value="'+l[d].path+'" '+m+">";i+='<label class="mail-connect-form-label mail-connect-form-label-check" for="imap-dir-sync-n'+d+'" '+(l[d].disabled?'style="color: #a0a0a0;"':"")+">"+l[d].name+"</label>";i+="</div>"}i+="</div>";i+='<div class="mail-connect-section-block">';i+='<div class="mail-connect-title-block">';i+='<div class="mail-connect-title">';i+=BX.message("MAIL_CLIENT_CONFIG_IMAP_DIRS_FOR");i+="</div></div>";for(var c in n){s="";o="";a='<input id="mail_connect_setup_dirs_'+c+'_placeholder" type="radio" name="imap_dirs['+c+']" value="" checked>';a+='<label for="mail_connect_setup_dirs_'+c+'_placeholder">'+BX.message("MAIL_CLIENT_CONFIG_IMAP_DIRS_EMPTY_DEFAULT")+"</label>";for(d=0;d<r;d++){if(l[d].disabled){continue}m="";if(l[d].path==n[c]){m="checked";a="";o="mail_connect_setup_dirs_"+c+"_"+(d+1)}s+='<input type="radio" name="imap_dirs['+c+']" value="'+BX.util.htmlspecialchars(l[d].path)+'" id="mail_connect_setup_dirs_'+c+"_"+(d+1)+'" '+m+">";s+='<label for="mail_connect_setup_dirs_'+c+"_"+(d+1)+'">'+BX.util.htmlspecialchars(l[d].item.join(" / "))+"</label>"}i+='<div class="mail-connect-option-email mail-connect-form-check-hidden">'+BX.message("MAIL_CLIENT_CONFIG_IMAP_DIRS_"+c.toUpperCase())+'<label class="mail-set-singleselect mail-set-singleselect-line" data-checked="'+o+'">\t\t\t\t\t\t\t\t\t<input id="mail_connect_setup_dirs_'+c+'_0" type="radio" name="imap_dirs['+c+']" value="0">\t\t\t\t\t\t\t\t\t<div class="mail-set-singleselect-wrapper">'+s+"</div>"+a+"</label>\t\t\t\t\t\t\t</div>"}i+="</div>";e.fulfill('<form class="mail-connect-setup-dirs-form" style="display: flex; flex-direction: column; height: 100%; ">\t\t\t\t\t\t\t\t<div style="padding: 0 20px 20px 20px; flex: 1; overflow: auto; ">\t\t\t\t\t\t\t\t\t<div class="mail-msg-sidepanel-header">\t\t\t\t\t\t\t\t\t\t<div class="mail-msg-sidepanel-title-container">\t\t\t\t\t\t\t\t\t\t\t<div class="mail-msg-sidepanel-title">\t\t\t\t\t\t\t\t\t\t\t\t<span class="mail-msg-sidepanel-title-text">'+BX.message("MAIL_CLIENT_CONFIG_IMAP_DIRS_TITLE")+'</span>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class="mail-connect mail-connect-slider">'+i+'</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div class="mail-connect-footer mail-connect-footer-fixed" style="position: static; ">\t\t\t\t\t\t\t\t\t<div class="mail-connect-footer-container">\t\t\t\t\t\t\t\t\t\t<button class="ui-btn ui-btn-md ui-btn-success ui-btn-success mail-connect-btn-connect" type="submit">'+BX.message("MAIL_CLIENT_CONFIG_IMAP_DIRS_BTN_SAVE")+'</button>\t\t\t\t\t\t\t\t\t\t<button class="ui-btn ui-btn-md ui-btn-link mail-connect-btn-cancel" type="reset">'+BX.message("MAIL_CLIENT_CONFIG_IMAP_DIRS_BTN_CANCEL")+"</button>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</form>");return e},events:{onLoad:function(s){var a=BX.findChildByClassName(s.slider.layout.content,"mail-connect-setup-dirs-form",true);top.BX.bind(a,"submit",function(o){o.preventDefault();var n=BX.ajax.prepareForm(a).data;if(n.imap_dirs){e.outcome=n.imap_dirs.outcome?[n.imap_dirs.outcome]:e.outcome;e.trash=n.imap_dirs.trash?[n.imap_dirs.trash]:e.trash;e.spam=n.imap_dirs.spam?[n.imap_dirs.spam]:e.spam;if(n.imap_dirs.sync){e.ignore=[];for(d in i){if(i.hasOwnProperty(d)){e.ignore.push(d)}}var l,r;for(l in n.imap_dirs.sync){if(n.imap_dirs.sync.hasOwnProperty(l)){r=BX.util.array_search(n.imap_dirs.sync[l],e.ignore);if(!(r<0)){e.ignore.splice(r,1)}}}}}t(n);s.slider.close()});top.BX.bind(a,"reset",function(t){s.slider.close()});var o=function(t){var e=BX.findChildren(t,{tag:"input",attr:{type:"radio"}},true);for(var i in e){BX.bind(e[i],"change",function(){if(this.checked){if(this.value==0){var e=BX(t.getAttribute("data-checked"));if(e){var i=BX.findNextSibling(this,{tag:"label",attr:{for:this.id}});var s=BX.findNextSibling(e,{tag:"label",attr:{for:e.id}});if(i&&s)BX.adjust(i,{text:s.innerHTML})}}else{t.setAttribute("data-checked",this.id)}}})}BX.bind(t,"click",function(e){e=e||window.event;e.skip_singleselect=t});BX.bind(s.getSlider().getContentContainer(),"click",function(e){e=e||window.event;if(e.skip_singleselect!==t){if(top.BX(t.getAttribute("data-checked"))){top.BX(t.getAttribute("data-checked")).checked=true}}})};var n=BX.findChildrenByClassName(s.getSlider().getContentContainer(),"mail-set-singleselect",true);for(var l in n)o(n[l])}}})}};window.BXMailMessageController=t;window.BXMailMessage=e;window.BXMailMailbox=i})();(function(){if(window!==window.top){return;BX.bind(window,"beforeunload",function(){document.body.style.opacity="0.4"})}var t=("/"+(BX.message.SITE_DIR||"/").replace(/[\\*+?.()|[\]{}]/g,"\\$&")+"/").replace(/\/+/g,"/");top.BX.SidePanel.Instance.bindAnchors({rules:[{condition:["^"+t+"mail/config/(new|edit)"],options:{width:760,cacheable:false}},{condition:["^"+t+"mail/(blacklist|signature|config|message)"],options:{width:1080}}]})})();
//# sourceMappingURL=script.map.js